# Railway MySQL Variables - Complete Reference

## Railway MySQL Service Variables (Auto-Generated)

When you create a MySQL service in Railway, these variables are automatically created:

### Direct MySQL Variables

```bash
MYSQL_DATABASE="railway"                    # Database name
MYSQL_ROOT_PASSWORD="<auto-generated>"       # Root password
MYSQLUSER="root"                            # Database user
MYSQLHOST="${{RAILWAY_PRIVATE_DOMAIN}}"    # Database host (internal)
MYSQLPORT="3306"                            # Database port
MYSQLPASSWORD="${{MYSQL_ROOT_PASSWORD}}"   # Password (references root password)
MYSQLDATABASE="${{MYSQL_DATABASE}}"        # Database name (references MYSQL_DATABASE)
```

### Connection URL Variables

```bash
MYSQL_URL="mysql://${{MYSQLUSER}}:${{MYSQL_ROOT_PASSWORD}}@${{RAILWAY_PRIVATE_DOMAIN}}:3306/${{MYSQL_DATABASE}}"
MYSQL_PUBLIC_URL="mysql://${{MYSQLUSER}}:${{MYSQL_ROOT_PASSWORD}}@${{RAILWAY_TCP_PROXY_DOMAIN}}:${{RAILWAY_TCP_PROXY_PORT}}/${{MYSQL_DATABASE}}"
```

## Laravel App Service Variables

In your **Laravel App Service** → **Variables**, use these exact mappings:

### Method 1: Using Railway Variable References (Recommended)

```bash
# Application
APP_NAME="Community News Portal"
APP_ENV=production
APP_DEBUG=false
APP_KEY=base64:v0ZMjx+sruecz7smNjk4mcdqzIOLEf1MUEuiEgFur2U=
APP_URL=${{RAILWAY_PUBLIC_DOMAIN}}

# Database - Using Railway's MySQL variables
DB_CONNECTION=mysql
DB_HOST=${{MYSQLHOST}}
DB_PORT=${{MYSQLPORT}}
DB_DATABASE=${{MYSQLDATABASE}}
DB_USERNAME=${{MYSQLUSER}}
DB_PASSWORD=${{MYSQLPASSWORD}}

# Session & Cache
SESSION_DRIVER=database
CACHE_DRIVER=database
QUEUE_CONNECTION=database
```

### Method 2: Using Direct Values (If References Don't Work)

If `${{MYSQLHOST}}` doesn't resolve, use Railway's private domain directly:

```bash
DB_CONNECTION=mysql
DB_HOST=${{RAILWAY_PRIVATE_DOMAIN}}
DB_PORT=3306
DB_DATABASE=railway
DB_USERNAME=root
DB_PASSWORD=${{MYSQL_ROOT_PASSWORD}}
```

## Variable Mapping Table

| Laravel Variable | Railway MySQL Variable | Example Value |
|-----------------|------------------------|---------------|
| `DB_HOST` | `${{MYSQLHOST}}` | `monorail.proxy.rlwy.net` |
| `DB_PORT` | `${{MYSQLPORT}}` | `3306` |
| `DB_DATABASE` | `${{MYSQLDATABASE}}` | `railway` |
| `DB_USERNAME` | `${{MYSQLUSER}}` | `root` |
| `DB_PASSWORD` | `${{MYSQLPASSWORD}}` | `zbcVtEtDlwaldvPyBFQZSpiqxXiKbAFY` |

## Step-by-Step Setup

### 1. Link MySQL Service to Laravel App

1. Go to **Laravel App Service** in Railway
2. Click **"+ New"** → **"Add Reference"**
3. Select your **MySQL service**
4. Railway automatically makes MySQL variables available

### 2. Add Laravel Database Variables

In **Laravel App Service** → **Variables**, add:

```bash
DB_CONNECTION=mysql
DB_HOST=${{MYSQLHOST}}
DB_PORT=${{MYSQLPORT}}
DB_DATABASE=${{MYSQLDATABASE}}
DB_USERNAME=${{MYSQLUSER}}
DB_PASSWORD=${{MYSQLPASSWORD}}
```

### 3. Verify Variables Are Available

After linking, you should see these variables in your Laravel App Service:
- `MYSQLHOST`
- `MYSQLPORT`
- `MYSQLDATABASE`
- `MYSQLUSER`
- `MYSQLPASSWORD`
- `MYSQL_ROOT_PASSWORD`

## Important Notes

### Variable Reference Syntax

Railway uses `${{VARIABLE_NAME}}` syntax to reference variables from other services.

- ✅ Correct: `DB_HOST=${{MYSQLHOST}}`
- ❌ Wrong: `DB_HOST=$MYSQLHOST`
- ❌ Wrong: `DB_HOST={{MYSQLHOST}}`

### Service Linking Required

For `${{MYSQLHOST}}` to work, you **must**:
1. Link the MySQL service to your Laravel app service
2. Use Railway's "Add Reference" feature
3. Not manually copy-paste variable values

### Variable Resolution

Railway resolves variables at runtime:
- `${{MYSQLHOST}}` → Actual hostname (e.g., `monorail.proxy.rlwy.net`)
- `${{MYSQLDATABASE}}` → Database name (e.g., `railway`)
- `${{MYSQLUSER}}` → Username (e.g., `root`)
- `${{MYSQLPASSWORD}}` → Password (actual password value)

## Troubleshooting

### Variables Not Resolving

**Problem:** `${{MYSQLHOST}}` shows as literal string

**Solution:**
1. Verify MySQL service is linked (Add Reference)
2. Check that variables exist in MySQL service
3. Try using direct values temporarily

### Connection Refused

**Problem:** Can't connect to database

**Solution:**
1. Verify `DB_HOST` uses `${{MYSQLHOST}}` or `${{RAILWAY_PRIVATE_DOMAIN}}`
2. Check MySQL service is running
3. Verify port is `3306`

### Access Denied

**Problem:** Authentication fails

**Solution:**
1. Verify `DB_USERNAME=${{MYSQLUSER}}` (should be `root`)
2. Check `DB_PASSWORD=${{MYSQLPASSWORD}}` matches MySQL service
3. Ensure MySQL service is in same Railway project

## Complete Example Configuration

Here's a complete `.env`-style configuration for Railway:

```bash
# Application
APP_NAME="Community News Portal"
APP_ENV=production
APP_DEBUG=false
APP_KEY=base64:v0ZMjx+sruecz7smNjk4mcdqzIOLEf1MUEuiEgFur2U=
APP_URL=${{RAILWAY_PUBLIC_DOMAIN}}

# Database (Railway MySQL Service)
DB_CONNECTION=mysql
DB_HOST=${{MYSQLHOST}}
DB_PORT=${{MYSQLPORT}}
DB_DATABASE=${{MYSQLDATABASE}}
DB_USERNAME=${{MYSQLUSER}}
DB_PASSWORD=${{MYSQLPASSWORD}}

# Alternative if MYSQLHOST doesn't work:
# DB_HOST=${{RAILWAY_PRIVATE_DOMAIN}}
# DB_DATABASE=railway
# DB_USERNAME=root
# DB_PASSWORD=${{MYSQL_ROOT_PASSWORD}}

# Session & Cache
SESSION_DRIVER=database
CACHE_DRIVER=database
QUEUE_CONNECTION=database

# Mail (if needed)
MAIL_MAILER=smtp
MAIL_HOST=smtp.mailtrap.io
MAIL_PORT=2525
MAIL_USERNAME=null
MAIL_PASSWORD=null
MAIL_ENCRYPTION=null
MAIL_FROM_ADDRESS="noreply@example.com"
MAIL_FROM_NAME="${APP_NAME}"
```

## Quick Reference Card

**Copy-paste these into Railway Variables:**

```bash
DB_CONNECTION=mysql
DB_HOST=${{MYSQLHOST}}
DB_PORT=${{MYSQLPORT}}
DB_DATABASE=${{MYSQLDATABASE}}
DB_USERNAME=${{MYSQLUSER}}
DB_PASSWORD=${{MYSQLPASSWORD}}
```

This is the **correct** and **recommended** way to configure Laravel with Railway MySQL!

